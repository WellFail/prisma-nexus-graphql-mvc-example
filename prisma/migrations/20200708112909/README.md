# Migration `20200708112909`

This migration has been generated by Eugene Barannik at 7/8/2020, 11:29:09 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "UserRole" AS ENUM ('ADMIN', 'EMPLOYEE');

CREATE TYPE "Currency" AS ENUM ('USD', 'EUR', 'RUB');

CREATE TABLE "public"."Account" (
"balance" Decimal(65,30)  NOT NULL DEFAULT 0,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"currency" "Currency" NOT NULL DEFAULT E'USD',"id" text  NOT NULL ,"name" text  NOT NULL ,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Transaction" (
"accountId" text  NOT NULL ,"amount" Decimal(65,30)  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."User" ADD COLUMN "roles" "UserRole"[]  ;

ALTER TABLE "public"."Post" DROP CONSTRAINT IF EXiSTS "Post_userId_fkey";

ALTER TABLE "public"."Account" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Transaction" ADD FOREIGN KEY ("accountId")REFERENCES "public"."Account"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."Post";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200708012236..20200708112909
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -13,11 +13,37 @@
     password                String
     firstName               String?
     middleName              String?
     lastName                String?
-    posts                   Post[]
+    roles                   UserRole[]
+    accounts                Account[]
 }
-model Post {
-    id                      String    @id @default(cuid())
-    title                   String?
+model Account {
+    id            String        @id @default(cuid())
+    createdAt     DateTime      @default(now())
+    name          String
+    currency      Currency      @default(USD)
+    balance       Float         @default(0)
+    user          User          @relation(fields: [userId])
+    userId        String
+    transactions  Transaction[]
 }
+
+model Transaction {
+    id        String            @id @default(cuid())
+    createdAt DateTime          @default(now())
+    amount    Float
+    account   Account           @relation(fields: [accountId])
+    accountId String
+}
+
+enum UserRole {
+    ADMIN
+    EMPLOYEE
+}
+
+enum Currency {
+    USD
+    EUR
+    RUB
+}
```


